name: Compilar Tesis y Presentación

on:
  push:
    branches: [ "main", "master" ]
  pull_request:
    branches: [ "main", "master" ]

jobs:
  build_latex:
    runs-on: ubuntu-latest
    container: texlive/texlive:latest

    steps:
      - name: Descargar repositorio
        uses: actions/checkout@v4

      # --- COMPILACIÓN DE LA TESIS ---
      # Ejecutamos los comandos directos para no llamar a Docker desde el Makefile
      - name: Compilar Tesis (Directo)
        run: |
          pdflatex -interaction=nonstopmode tesis.tex
          biber tesis
          pdflatex -interaction=nonstopmode tesis.tex
          pdflatex -interaction=nonstopmode tesis.tex

      # --- COMPILACIÓN DE LA PRESENTACIÓN ---
      - name: Compilar Presentación (Directo)
        if: always() # Ejecutar aunque falle la tesis
        run: |
          pdflatex -interaction=nonstopmode presentacion.tex
          # No necesitamos biber aquí si no hay citas, si las hay, descomenta la linea de abajo:
          # biber presentacion || true
          pdflatex -interaction=nonstopmode presentacion.tex

      # --- SUBIR RESULTADOS ---
      - name: Subir PDFs
        uses: actions/upload-artifact@v4
        with:
          name: Documentos_Finales
          path: |
            tesis.pdf
            presentacion.pdf
          if-no-files-found: warn
