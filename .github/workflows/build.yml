name: Compilar Tesis y Presentación

on:
  push:
    branches: [ "main", "master" ]
  pull_request:
    branches: [ "main", "master" ]

jobs:
  build_latex:
    runs-on: ubuntu-latest
    # USAMOS UNA IMAGEN YA LISTA (Aquí está el truco de velocidad)
    # Esta imagen ya tiene todo texlive-full preinstalado.
    container: texlive/texlive:latest

    steps:
      - name: Descargar repositorio
        uses: actions/checkout@v4

      # A veces la imagen base no trae 'make', lo instalamos en 2 segundos
      - name: Instalar Make
        run: |
          apt-get update
          apt-get install -y make

      # Compilamos la Tesis
      - name: Compilar Tesis
        run: make tesis

      # Compilamos la Presentación
      # Usamos el 'continue-on-error' por si la presentación falla,
      # que no nos oculte el PDF de la tesis si ya salió bien.
      - name: Compilar Presentación
        run: make slides || true

      # Subimos los PDFs resultantes para que los puedas descargar
      - name: Subir Artefactos (PDFs)
        uses: actions/upload-artifact@v4
        with:
          name: Documentos_Finales
          path: |
            tesis.pdf
            presentacion.pdf
          if-no-files-found: warn
