name: CI Tesis Modular

on:
  push:
    branches: [ main, master ]
  pull_request:

jobs:
  compile:
    runs-on: ubuntu-latest

    steps:
      # 1. Bajar el cÃ³digo (INDISPENSABLE)
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4

      # 2. Construir la imagen limpia (rÃ¡pido, sin archivos dentro)
      - name: ğŸ³ Build Docker image
        run: docker build -t tesis-bsf .

      # 3. Compilar usando TU Makefile (Magia aquÃ­ âœ¨)
      #    Esto usa automÃ¡ticamente $(CURDIR) para montar el volumen correctamente
      - name: ğŸ“œ Compile Thesis (via Make)
        run: make tesis

      - name: ğŸï¸ Compile Slides (via Make)
        run: make slides

      # 4. Subir los PDFs (estÃ¡n en la raÃ­z, no dentro de docker)
      - name: ğŸ“¤ Upload Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: Resultados_Compilacion
          path: |
            tesis.pdf
            presentacion.pdf
